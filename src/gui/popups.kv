#:kivy 2.3.1
#:import dp kivy.metrics.dp

<BasePopup>:
    background: ''
    separator_color: 0.4, 0.5, 0.8, 1
    title_align: 'center'
    title_size: dp(20)
    
    canvas.before:
        Color:
            rgba: 0.96, 0.96, 0.98, 1
        RoundedRectangle:
            pos: self.pos
            size: self.size
            radius: [dp(20),]
        Color:
            rgba: 0.8, 0.8, 0.85, 1
        Line:
            width: dp(2)
            rounded_rectangle: [self.x, self.y, self.width, self.height, dp(20)]

<AddTaskPopup>:
    size_hint: (0.8, 0.5)
    title: 'Add Task'

    BoxLayout:
        orientation: 'vertical'
        padding: [dp(20), dp(15), dp(20), dp(15)]
        spacing: dp(15)

        Label:
            text: 'Enter your task:'
            font_size: dp(18)
            font_name: app.font_family  
            color: 0.3, 0.3, 0.4, 1
            size_hint_y: 0.12
            text_size: self.width, None
            halign: 'center'
            valign: 'middle'

        TextInput:
            id: task_input
            size_hint_y: 0.18
            hint_text: 'e.g., Call Daughter...'
            hint_text_color: 0.6, 0.6, 0.6, 1
            font_name: app.font_family  
            multiline: False
            background_normal: ''
            background_active: ''
            background_color: 0.95, 0.95, 0.95, 1
            foreground_color: 0, 0, 0, 1
            font_size: dp(16)
            padding: [dp(10), dp(8)]
            canvas.before:
                Color:
                    rgba: 0.7, 0.7, 0.7, 1
                Line:
                    width: dp(1.5)
                    rounded_rectangle: [self.x, self.y, self.width, self.height, dp(6)]

        BoxLayout:
            orientation: 'horizontal'
            size_hint_y: 0.18
            spacing: dp(10)
            
            Label:
                text: 'TIME:'
                font_size: dp(18)
                font_name: app.font_family
                color: 0.3, 0.3, 0.4, 1
                size_hint_x: 0.25
                text_size: self.width, None
                halign: 'center'
                valign: 'middle'

            TextInput:
                id: time_input
                size_hint_x: 0.15
                hint_text: '06:00'
                hint_text_color: 0.6, 0.6, 0.6, 1
                text: ''
                font_name: app.font_family  
                multiline: False
                background_normal: ''
                background_active: ''
                background_color: 0.95, 0.95, 0.95, 1
                foreground_color: 0, 0, 0, 1
                padding: [dp(8), dp(8)]
                font_size: dp(16)
                canvas.before:
                    Color:
                        rgba: 0.7, 0.7, 0.7, 1
                    Line:
                        width: dp(1.5)
                        rounded_rectangle: [self.x, self.y, self.width, self.height, dp(6)]

            Spinner:
                id: am_pm_spinner
                size_hint_x: 0.12
                text: 'AM'
                values: ['AM', 'PM']
                font_name: app.font_family  
                background_normal: ''
                background_color: 0.95, 0.95, 0.95, 1
                color: 0, 0, 0, 1
                font_size: dp(18)
                canvas.before:
                    Color:
                        rgba: 0.7, 0.7, 0.7, 1
                    Line:
                        width: dp(1.5)
                        rounded_rectangle: [self.x, self.y, self.width, self.height, dp(6)]

            Widget:
                size_hint_x: 0.3

        BoxLayout:
            orientation: 'horizontal'
            size_hint_y: 0.2
            spacing: dp(15)
            padding: [dp(20), dp(5), dp(20), 0]

            Button:
                text: 'Cancel'
                font_size: dp(18)
                font_name: app.font_family  
                background_normal: ''
                background_color: 0, 0, 0, 0
                color: 1, 1, 1, 1
                on_press: root.dismiss()
                canvas.before:
                    Color:
                        rgba: 0.9, 0.3, 0.3, 1
                    RoundedRectangle:
                        pos: self.pos
                        size: self.size
                        radius: [dp(8),]

            Button:
                text: 'Save Task'
                font_size: dp(18)
                font_name: app.font_family  
                background_normal: ''
                background_color: 0, 0, 0, 0
                color: 1, 1, 1, 1
                on_press: root.save_task()
                canvas.before:
                    Color:
                        rgba: 0.36, 0.52, 0.96, 1
                    RoundedRectangle:
                        pos: self.pos
                        size: self.size
                        radius: [dp(8),]

<ConfirmationPopup>:
    size_hint: (0.8, 0.5)
    title: root.popup_title

    BoxLayout:
        orientation: 'vertical'
        padding: [dp(20), dp(15), dp(20), dp(15)]
        spacing: dp(15)

        Label:
            text: root.confirmation_text
            font_size: dp(18)
            font_name: app.font_family  
            color: 0.3, 0.3, 0.4, 1
            size_hint_y: 0.6
            text_size: self.width, None
            halign: 'center'
            valign: 'middle'

        BoxLayout:
            orientation: 'horizontal'
            size_hint_y: 0.3
            spacing: dp(15)
            padding: [dp(30), 0]

            Button:
                text: 'OK'
                font_size: dp(18)
                font_name: app.font_family 
                background_normal: ''
                background_color: 0, 0, 0, 0
                color: 1, 1, 1, 1
                on_press: root.dismiss()
                canvas.before:
                    Color:
                        rgba: 0.36, 0.52, 0.96, 1
                    RoundedRectangle:
                        pos: self.pos
                        size: self.size
                        radius: [dp(8),]

<ListeningPopup>:
    size_hint: (0.8, 0.5)
    title: 'Listening...'

    BoxLayout:
        orientation: 'vertical'
        padding: [dp(20), dp(15), dp(20), dp(15)]
        spacing: dp(15)

        Label:
            text: 'Speak your command now'
            font_size: dp(18)
            font_name: app.font_family 
            color: 0.1, 0.1, 0.1, 1
            size_hint_y: 0.3
            text_size: self.width, None
            halign: 'center'
            valign: 'middle'

        BoxLayout:
            orientation: 'horizontal'
            size_hint_y: 0.4
            padding: [dp(20), 0]

            Image:
                source: 'assets/icons/listen.png'
                size_hint_x: 0.4
                pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                fit_mode: 'contain'

        BoxLayout:
            orientation: 'horizontal'
            size_hint_y: 0.2
            spacing: dp(15)
            padding: [dp(30), 0]

            Button:
                text: 'Cancel'
                font_size: dp(18)
                font_name: app.font_family  
                background_normal: ''
                background_color: 0, 0, 0, 0
                color: 1, 1, 1, 1
                on_press: root.dismiss()
                canvas.before:
                    Color:
                        rgba: 0.8, 0.2, 0.2, 1
                    RoundedRectangle:
                        pos: self.pos
                        size: self.size
                        radius: [dp(8),]
                        
<SettingsConfirmationPopup>:
    size_hint: (0.8, 0.5)
    title: 'Default Settings'

    BoxLayout:
        orientation: 'vertical'
        padding: [dp(20), dp(15), dp(20), dp(15)]
        spacing: dp(15)
        
        Label:
            text: getattr(root, 'confirmation_text', 'Settings saved')
            font_size: dp(18)
            font_name: app.font_family 
            color: 0.1, 0.1, 0.1, 1
            size_hint_y: 0.6
            text_size: self.width, None
            halign: 'center'
            valign: 'middle'
            
        BoxLayout:
            orientation: 'horizontal'
            size_hint_y: 0.3
            spacing: dp(15)
            padding: [dp(30), 0]
            
            Button:
                text: 'OK'
                font_size: dp(18)
                font_name: app.font_family
                background_normal: ''
                background_color: 0, 0, 0, 0
                color: 1, 1, 1, 1
                on_release: root.dismiss()
                canvas.before:
                    Color:
                        rgba: 0.36, 0.52, 0.96, 1
                    RoundedRectangle:
                        pos: self.pos
                        size: self.size
                        radius: [dp(8),]

<DefaultSettingsPopup>:
    size_hint: (0.6, 0.4)
    title: 'Default Settings'

    BoxLayout:
        orientation: 'vertical'
        padding: [dp(20), dp(15), dp(20), dp(15)]
        spacing: dp(15)
        
        Label:
            text: getattr(root, 'confirmation_text', 'Default settings restored!')
            font_size: dp(18)
            font_name: app.font_family 
            color: 0.1, 0.1, 0.1, 1
            size_hint_y: 0.6
            text_size: self.width, None
            halign: 'center'
            valign: 'middle'
            
        BoxLayout:
            orientation: 'horizontal'
            size_hint_y: 0.3
            spacing: dp(15)
            padding: [dp(30), 0]
            
            Button:
                text: 'OK'
                font_size: dp(18)
                font_name: app.font_family
                background_normal: ''
                background_color: 0, 0, 0, 0
                color: 1, 1, 1, 1
                on_release: root.dismiss()
                canvas.before:
                    Color:
                        rgba: 0.36, 0.52, 0.96, 1
                    RoundedRectangle:
                        pos: self.pos
                        size: self.size
                        radius: [dp(8),]

<AlarmPopup>:
    size_hint: (0.8, 0.5)
    title: 'REMINDER'
    auto_dismiss: False
    
    canvas.before:
        Color:
            rgba: 1, 0.95, 0.9, 1
        RoundedRectangle:
            pos: self.pos
            size: self.size
            radius: [dp(20),]
        Color:
            rgba: 0.9, 0.3, 0.3, 1
        Line:
            width: dp(2)
            rounded_rectangle: [self.x, self.y, self.width, self.height, dp(20)]

    BoxLayout:
        orientation: 'vertical'
        padding: [dp(20), dp(15), dp(20), dp(15)]
        spacing: dp(15)

        Label:
            text: 'TASK REMINDER'
            font_size: dp(32)
            font_name: app.font_family
            bold: True
            color: 0.8, 0.2, 0.2, 1
            size_hint_y: 0.3
            text_size: self.width, None
            halign: 'center'
            valign: 'middle'

        Label:
            text: root.task.title + '\\n\\nTime: ' + root.task.due_time
            font_size: dp(18)
            font_name: app.font_family
            color: 0.2, 0.2, 0.2, 1
            size_hint_y: 0.5
            text_size: self.width, None
            halign: 'center'
            valign: 'middle'

        Button:
            text: 'Dismiss'
            font_size: dp(18)
            font_name: app.font_family
            background_normal: ''
            background_color: 0, 0, 0, 0
            color: 1, 1, 1, 1
            on_press: root.dismiss_alarm()
            canvas.before:
                Color:
                    rgba: 0.36, 0.52, 0.96, 1
                RoundedRectangle:
                    pos: self.pos
                    size: self.size
                    radius: [dp(8),]